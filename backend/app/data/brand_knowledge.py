"""
Static brand knowledge base for auto parts manufacturers.

Each brand profile includes tier classification, quality/value scores,
known specialties, and geographic origin. Seeded from existing _KNOWN_BRANDS
in cross_reference.py plus additional research.

Tiers:
  - oem: Original Equipment Manufacturer (factory parts)
  - premium_aftermarket: High-quality aftermarket, often OE supplier
  - economy: Good quality, lower price point
  - budget: Lowest cost, basic quality
"""

BRAND_PROFILES: dict[str, dict] = {
    # --- OEM / OES Suppliers (these companies make parts for the factory) ---
    "Lemforder": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 7.0,
        "known_for": ["engine mounts", "suspension", "steering", "bushings"],
        "country": "Germany",
        "parent_company": "ZF Friedrichshafen",
        "description": "OE supplier for BMW, Mercedes, VW/Audi. Premium German engineering.",
    },
    "Sachs": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 7.0,
        "known_for": ["clutch", "shock absorbers", "struts"],
        "country": "Germany",
        "parent_company": "ZF Friedrichshafen",
        "description": "OE supplier for most European brands. Top-tier clutch and damper manufacturer.",
    },
    "Bilstein": {
        "tier": "premium_aftermarket",
        "quality_score": 9.5,
        "value_score": 6.5,
        "known_for": ["shock absorbers", "struts", "suspension"],
        "country": "Germany",
        "parent_company": "ThyssenKrupp",
        "description": "Premium performance suspension. OE on many European sports cars.",
    },
    "Bosch": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 8.0,
        "known_for": ["ignition", "fuel systems", "sensors", "wipers", "starters", "alternators"],
        "country": "Germany",
        "parent_company": "Robert Bosch GmbH",
        "description": "World's largest automotive supplier. OE for most manufacturers.",
    },
    "Brembo": {
        "tier": "premium_aftermarket",
        "quality_score": 9.5,
        "value_score": 6.0,
        "known_for": ["brake rotors", "brake calipers", "brake pads"],
        "country": "Italy",
        "parent_company": "Brembo S.p.A.",
        "description": "Premium brake manufacturer. OE on Ferrari, Porsche, BMW M, AMG.",
    },
    "Valeo": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.5,
        "known_for": ["clutch", "starters", "alternators", "lighting", "wipers"],
        "country": "France",
        "parent_company": "Valeo SA",
        "description": "Major OE supplier, especially for European and Asian brands.",
    },
    "Denso": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 7.5,
        "known_for": ["spark plugs", "starters", "alternators", "A/C", "fuel pumps"],
        "country": "Japan",
        "parent_company": "Denso Corporation",
        "description": "Toyota group supplier. OE for most Japanese manufacturers.",
    },
    "NGK": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 8.5,
        "known_for": ["spark plugs", "ignition coils", "oxygen sensors"],
        "country": "Japan",
        "parent_company": "NGK Spark Plug Co.",
        "description": "World's leading spark plug manufacturer. OE for virtually all brands.",
    },
    "ATE": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["brake pads", "brake rotors", "brake fluid", "calipers"],
        "country": "Germany",
        "parent_company": "Continental AG",
        "description": "OE brake supplier for VW/Audi, BMW, Mercedes. Excellent quality.",
    },
    "LuK": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 7.0,
        "known_for": ["clutch kits", "flywheels", "clutch hydraulics"],
        "country": "Germany",
        "parent_company": "Schaeffler Group",
        "description": "World's largest clutch manufacturer. OE for most brands.",
    },
    "INA": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["timing components", "tensioners", "bearings"],
        "country": "Germany",
        "parent_company": "Schaeffler Group",
        "description": "OE timing system and bearing supplier.",
    },
    "SKF": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 7.5,
        "known_for": ["wheel bearings", "seals", "hub assemblies"],
        "country": "Sweden",
        "parent_company": "SKF Group",
        "description": "World leader in bearings. OE for virtually all manufacturers.",
    },
    "FAG": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["wheel bearings", "hub assemblies"],
        "country": "Germany",
        "parent_company": "Schaeffler Group",
        "description": "Premium bearing manufacturer, sister brand to INA/LuK.",
    },
    "Gates": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 8.0,
        "known_for": ["timing belts", "serpentine belts", "hoses", "water pumps"],
        "country": "USA",
        "parent_company": "Gates Corporation",
        "description": "Leading belt and hose manufacturer. OE supplier to many brands.",
    },
    "Continental": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["timing belts", "serpentine belts", "sensors"],
        "country": "Germany",
        "parent_company": "Continental AG",
        "description": "Major OE supplier. Also owns ATE (brakes) and VDO.",
    },
    "Mann": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 8.0,
        "known_for": ["oil filters", "air filters", "fuel filters", "cabin filters"],
        "country": "Germany",
        "parent_company": "Mann+Hummel",
        "description": "OE filter supplier for BMW, Mercedes, VW/Audi, and many others.",
    },
    "Mahle": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["filters", "pistons", "gaskets", "turbochargers"],
        "country": "Germany",
        "parent_company": "Mahle GmbH",
        "description": "Major OE supplier for engine components and filtration.",
    },
    "Hengst": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["oil filters", "air filters", "fuel filters"],
        "country": "Germany",
        "parent_company": "Hengst SE",
        "description": "OE filter supplier, especially for European vehicles.",
    },
    "Pierburg": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.0,
        "known_for": ["fuel pumps", "EGR valves", "intake manifolds", "vacuum pumps"],
        "country": "Germany",
        "parent_company": "Rheinmetall",
        "description": "OE supplier for fuel and air management systems.",
    },
    "VDO": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.0,
        "known_for": ["sensors", "fuel pumps", "window regulators"],
        "country": "Germany",
        "parent_company": "Continental AG",
        "description": "OE supplier for sensors and fuel system components.",
    },
    "Hella": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.0,
        "known_for": ["headlights", "tail lights", "sensors", "electronics"],
        "country": "Germany",
        "parent_company": "HELLA GmbH & Co. KGaA",
        "description": "OE lighting and electronics supplier for European brands.",
    },
    "Nissens": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.5,
        "known_for": ["radiators", "condensers", "intercoolers", "oil coolers"],
        "country": "Denmark",
        "parent_company": "Nissens A/S",
        "description": "Leading OE-quality cooling system manufacturer.",
    },
    "Behr": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.0,
        "known_for": ["radiators", "A/C condensers", "blower motors", "thermostats"],
        "country": "Germany",
        "parent_company": "Mahle GmbH",
        "description": "OE cooling and climate control supplier.",
    },
    "Elring": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["gaskets", "seals", "valve cover gaskets"],
        "country": "Germany",
        "parent_company": "ElringKlinger AG",
        "description": "OE gasket and sealing manufacturer for European vehicles.",
    },
    "Victor Reinz": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.5,
        "known_for": ["gaskets", "seals", "head gaskets"],
        "country": "Germany",
        "parent_company": "Dana Incorporated",
        "description": "Premium OE-quality gasket manufacturer.",
    },
    "Corteco": {
        "tier": "premium_aftermarket",
        "quality_score": 7.5,
        "value_score": 7.5,
        "known_for": ["seals", "gaskets", "engine mounts", "transmission mounts"],
        "country": "Germany",
        "parent_company": "Freudenberg Group",
        "description": "OE supplier for sealing and vibration control.",
    },
    "Zimmermann": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.0,
        "known_for": ["brake rotors", "sport rotors"],
        "country": "Germany",
        "parent_company": "Otto Zimmermann GmbH",
        "description": "German brake rotor specialist, known for cross-drilled sport rotors.",
    },
    "Textar": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 7.0,
        "known_for": ["brake pads", "brake shoes"],
        "country": "Germany",
        "parent_company": "TMD Friction",
        "description": "OE brake pad supplier for European luxury brands.",
    },
    "Pagid": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.5,
        "known_for": ["brake pads"],
        "country": "Germany",
        "parent_company": "TMD Friction",
        "description": "OE brake pad manufacturer, sister brand to Textar.",
    },
    # --- Good aftermarket (quality, good value) ---
    "Meyle": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.5,
        "known_for": ["suspension", "steering", "engine mounts", "control arms"],
        "country": "Germany",
        "parent_company": "Meyle AG",
        "description": "Good-value German aftermarket. HD line offers improved durability.",
    },
    "Febi": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.5,
        "known_for": ["suspension", "steering", "engine components", "fluids"],
        "country": "Germany",
        "parent_company": "Bilstein Group (not Bilstein shocks)",
        "description": "Wide-range German aftermarket supplier with good coverage.",
    },
    "TRW": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 8.0,
        "known_for": ["brake pads", "control arms", "tie rods", "ball joints"],
        "country": "Germany",
        "parent_company": "ZF Friedrichshafen",
        "description": "Major OE supplier for steering and braking components.",
    },
    "Moog": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.5,
        "known_for": ["ball joints", "tie rods", "control arms", "sway bar links"],
        "country": "USA",
        "parent_company": "DRiV (Tenneco)",
        "description": "Leading chassis parts brand in North America. Problem-solver designs.",
    },
    "Delphi": {
        "tier": "premium_aftermarket",
        "quality_score": 7.5,
        "value_score": 7.5,
        "known_for": ["ignition", "fuel injection", "sensors", "suspension"],
        "country": "UK",
        "parent_company": "BorgWarner",
        "description": "Former GM parts division. OE-quality electrical and fuel components.",
    },
    "Monroe": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.5,
        "known_for": ["shock absorbers", "struts"],
        "country": "USA",
        "parent_company": "DRiV (Tenneco)",
        "description": "Widely available shock/strut brand. Good value for daily drivers.",
    },
    "KYB": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 8.0,
        "known_for": ["shock absorbers", "struts"],
        "country": "Japan",
        "parent_company": "KYB Corporation",
        "description": "OE supplier for many Japanese brands. Excel-G line is very popular.",
    },
    "Koni": {
        "tier": "premium_aftermarket",
        "quality_score": 9.0,
        "value_score": 6.5,
        "known_for": ["shock absorbers", "performance suspension"],
        "country": "Netherlands",
        "parent_company": "ITT Inc.",
        "description": "Premium adjustable performance shocks.",
    },
    "Centric": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.5,
        "known_for": ["brake rotors", "brake pads", "calipers"],
        "country": "USA",
        "parent_company": "Centric Parts",
        "description": "Good-value brake components with wide application coverage.",
    },
    "EBC": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.0,
        "known_for": ["brake pads", "brake rotors"],
        "country": "UK",
        "parent_company": "EBC Brakes",
        "description": "Performance brake specialist. Popular for spirited driving.",
    },
    "Hawk": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 6.5,
        "known_for": ["brake pads", "performance brakes"],
        "country": "USA",
        "parent_company": "Hawk Performance",
        "description": "Performance/racing brake pad specialist.",
    },
    "StopTech": {
        "tier": "premium_aftermarket",
        "quality_score": 8.5,
        "value_score": 6.0,
        "known_for": ["brake kits", "rotors", "calipers"],
        "country": "USA",
        "parent_company": "Centric Parts",
        "description": "Performance big brake kit manufacturer.",
    },
    "Dayco": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.5,
        "known_for": ["timing belts", "serpentine belts", "tensioners"],
        "country": "USA",
        "parent_company": "Dayco Products",
        "description": "Reliable belt and tensioner manufacturer at good prices.",
    },
    "Beck Arnley": {
        "tier": "premium_aftermarket",
        "quality_score": 7.5,
        "value_score": 7.5,
        "known_for": ["filters", "brake pads", "engine components"],
        "country": "USA",
        "parent_company": "Dorman Products",
        "description": "Sources OE-quality parts for import vehicles.",
    },
    "Rein": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.0,
        "known_for": ["cooling hoses", "gaskets", "engine components"],
        "country": "USA",
        "parent_company": "CRP Industries",
        "description": "Aftermarket parts focused on European vehicles.",
    },
    "Osram": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.5,
        "known_for": ["headlight bulbs", "lighting"],
        "country": "Germany",
        "parent_company": "ams-OSRAM AG",
        "description": "OE lighting supplier for most European manufacturers.",
    },
    "Philips": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.5,
        "known_for": ["headlight bulbs", "lighting"],
        "country": "Netherlands",
        "parent_company": "Lumileds",
        "description": "OE-quality automotive lighting.",
    },
    "Mintex": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.0,
        "known_for": ["brake pads", "brake shoes"],
        "country": "UK",
        "parent_company": "TMD Friction",
        "description": "Value brake pad brand from the same group as Textar/Pagid.",
    },
    "Jurid": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.0,
        "known_for": ["brake pads"],
        "country": "Germany",
        "parent_company": "TMD Friction",
        "description": "Economy brake pad option from TMD Friction group.",
    },
    "Siemens": {
        "tier": "premium_aftermarket",
        "quality_score": 8.0,
        "value_score": 7.0,
        "known_for": ["fuel injectors", "sensors", "electronics"],
        "country": "Germany",
        "parent_company": "Siemens AG / Continental",
        "description": "OE electronic and fuel system components.",
    },
    "Boge": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.0,
        "known_for": ["shock absorbers", "struts"],
        "country": "Germany",
        "parent_company": "ZF Friedrichshafen",
        "description": "Economy shock brand from ZF, sister to Sachs.",
    },
    "Ajusa": {
        "tier": "economy",
        "quality_score": 6.5,
        "value_score": 8.5,
        "known_for": ["gaskets", "head gaskets", "seals"],
        "country": "Spain",
        "parent_company": "Ajusa S.A.",
        "description": "European gasket manufacturer at competitive prices.",
    },
    # --- OEM brands (dealer parts) ---
    "Motorcraft": {
        "tier": "oem",
        "quality_score": 8.5,
        "value_score": 7.0,
        "known_for": ["all Ford parts"],
        "country": "USA",
        "parent_company": "Ford Motor Company",
        "description": "Ford's official OEM parts brand.",
    },
    "AC Delco": {
        "tier": "oem",
        "quality_score": 8.0,
        "value_score": 7.0,
        "known_for": ["all GM parts"],
        "country": "USA",
        "parent_company": "General Motors",
        "description": "GM's official OEM parts brand.",
    },
    "Acdelco": {
        "tier": "oem",
        "quality_score": 8.0,
        "value_score": 7.0,
        "known_for": ["all GM parts"],
        "country": "USA",
        "parent_company": "General Motors",
        "description": "GM's official OEM parts brand.",
    },
    "Mopar": {
        "tier": "oem",
        "quality_score": 8.0,
        "value_score": 7.0,
        "known_for": ["all Chrysler/Dodge/Jeep/Ram parts"],
        "country": "USA",
        "parent_company": "Stellantis",
        "description": "Chrysler group's official OEM parts brand.",
    },
    # --- Budget / Economy ---
    "Dorman": {
        "tier": "economy",
        "quality_score": 6.0,
        "value_score": 9.0,
        "known_for": ["hardware", "body parts", "interior parts", "engine components"],
        "country": "USA",
        "parent_company": "Dorman Products Inc.",
        "description": "Huge catalog of replacement parts. Great for hard-to-find items. Variable quality.",
    },
    "Standard": {
        "tier": "economy",
        "quality_score": 7.0,
        "value_score": 8.0,
        "known_for": ["ignition", "fuel injection", "sensors", "electrical"],
        "country": "USA",
        "parent_company": "Standard Motor Products",
        "description": "Large ignition and engine management parts manufacturer.",
    },
    "Cardone": {
        "tier": "budget",
        "quality_score": 5.5,
        "value_score": 9.0,
        "known_for": ["remanufactured calipers", "power steering", "window motors"],
        "country": "USA",
        "parent_company": "Cardone Industries",
        "description": "Largest remanufacturer in North America. Budget-friendly reman parts.",
    },
    "URO": {
        "tier": "budget",
        "quality_score": 5.0,
        "value_score": 9.5,
        "known_for": ["European vehicle parts", "cooling", "body parts"],
        "country": "Taiwan",
        "parent_company": "URO Parts",
        "description": "Budget parts for European vehicles. Lowest price point, basic quality.",
    },
    "Depo": {
        "tier": "budget",
        "quality_score": 5.0,
        "value_score": 9.0,
        "known_for": ["headlights", "tail lights", "mirrors"],
        "country": "Taiwan",
        "parent_company": "TYC Brother Industrial",
        "description": "Budget replacement lighting. Acceptable for daily drivers.",
    },
    "Tokico": {
        "tier": "economy",
        "quality_score": 6.5,
        "value_score": 7.5,
        "known_for": ["shock absorbers"],
        "country": "Japan",
        "parent_company": "Hitachi Astemo",
        "description": "Japanese shock absorber manufacturer.",
    },
}


def get_brand_profile(brand_name: str) -> dict | None:
    """Look up a brand profile by name (case-insensitive)."""
    # Direct match
    if brand_name in BRAND_PROFILES:
        return BRAND_PROFILES[brand_name]

    # Case-insensitive match
    brand_lower = brand_name.lower()
    for key, profile in BRAND_PROFILES.items():
        if key.lower() == brand_lower:
            return profile

    return None


def get_brand_tier(brand_name: str) -> str:
    """Get the tier for a brand, defaulting to 'unknown'."""
    profile = get_brand_profile(brand_name)
    return profile["tier"] if profile else "unknown"
